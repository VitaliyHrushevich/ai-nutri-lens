import re


def filter_ingredients(tokens):
    stop_words = ['—Ç–µ–ª', '–∞–¥—Ä–µ—Å', '—Ä–µ—Å–ø—É–±–ª–∏–∫–∞', 'email', '–≥–æ–¥', '–≥–æ—Å—Ç', '—Ç—É —Ä–±', '–æ–Ω—ã–Ω', '–∫—É—Ä–∞–º—ã']
    clean_ingredients = []

    for token in tokens:
        # Delete extra blanks at the beginning and end
        token = token.strip()

        # 1. Skips very short garbage
        if len(token) < 3:
            continue

        if len(token) > 60:
            # Unstructured Block
            clean_ingredients.append(token)
            continue

        # 3. Normal filtering for standart tokens
        is_trash = any(word in token for word in stop_words)
        if not is_trash:
            clean_ingredients.append(token)

    return clean_ingredients


def clean_and_split(raw_text):
    text = raw_text.lower()
    print(f"DEBUG: –ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª–∏–Ω–æ–π {len(text)} —Å–∏–º–≤–æ–ª–æ–≤")  # –ü—Ä–æ–≤–µ—Ä–∫–∞ 1

    start_keywords = ['—Å–æ—Å—Ç–∞–≤:', '–∫—É—Ä–∞–º—ã:', '–∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã:', '—Å–æ—Åi–∞b', '—Å–æ—Å–ø–∞–≤']  # –î–æ–±–∞–≤–∏–ª–∏ —Ç–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ OCR
    start_index = -1
    for key in start_keywords:
        if key in text:
            start_index = text.find(key) + len(key)
            print(f"DEBUG: –ù–∞–π–¥–µ–Ω–æ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ '{key}' –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ {start_index}")
            break

    content = text[start_index:] if start_index != -1 else text
    if start_index == -1:
        print("DEBUG: –ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –±–µ—Ä–µ–º –≤–µ—Å—å —Ç–µ–∫—Å—Ç")

    cleaned = re.sub(r'[^–∞-—èa-z0-9,\s]', '', content)
    raw_tokens = [t.strip() for t in cleaned.split(',')]
    print(f"DEBUG: –ù–∞—Ä–µ–∑–∞–Ω–æ {len(raw_tokens)} —Å—ã—Ä—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤")

    final_list = filter_ingredients(raw_tokens)
    print(f"DEBUG: –ü–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –æ—Å—Ç–∞–ª–æ—Å—å {len(final_list)} —Ç–æ–∫–µ–Ω–æ–≤")

    return final_list


if __name__ == "__main__":

    raw_data = """–∂X–∂ X –ú–û–õ–û–ö–û –ß–ê–°–¢–ò–ß–ù–û –û–ë–ï–ó–ñ–ò–†–ï–ù–û–ï –°–ì–£–©–ï–ù–ù–û–ï –° –°–ê–•–ê–†–û–ú –ò KA–ö–ê–° –ú–ê–°–°–û–í–ê–Ø –î–û–õ–Ø –ñ–ò–†–ê75% RlS) –ü—Ä–æ–¥—É—Ç –ø—Ä–∏–≥–æ–¥–µ–Ω –¥–ª—è –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ 8 –ü–ò–®—É –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è –üO –≤–∫–£–°–£ 8 –ü–∏—â–µ–≤–∞—è —Ü–µ–ê–Ω–û–°–¢–¨ –ö–ò–ü–Ø–ß–û–ù–£–Æ –í–û–î–£ (–æ–°i–∞b_–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –º–æ–ø–æ- –∞ 100 –≥ –ö–û, —Å–∞x–∞—Ä ((–∞–∫–∞—Ä–æ–∑–∞, –ª–∞–∫–æ–∑–∞–Ω—Ö–∞–∫–∞–æ-–ø–æ—Ä–æ—à–æ–∫ –ø–µ- –ù–û–ì–∞–°–ò–¢–µ–õ–¨ ((500 ii) –∂–∏—Ä–´  –±–†–õ–ö–ò –ò–õ–û–í–û–õ–´ –í –Æ–ù–ß–Æ–¶] –¢–£ –†–ë 100198867122-2001 –¢–ò BY 39153095.080-2020 –¢–æ–¥–µ–Ω –í –ú–ß–û–ù–ò–° 12 –ú–ï–°–Ø–¶–ï–í —Å –º–æ–º–µ–Ω—Ç–∞ –∏–∑- 7,5 921 546 –≥ 4351 –ì–û–¢–û–í–õ–ï–ù–ò–Ø –í –¶–í–õ–û–ô —É–ü–∞–ö–û–í–ö–µ: –•—Ä–∞–ù–ò–¢–¨ –ø—Ä–∏ —Ç–µ–º–ø–µ —Ä—Ç–µ—Ç–∏—á–µ—Å–∫—è—Ç 0 —Ä–∞—Ç—É—Ä–µ 0I (–î–û +10 "( –∏ –æ—Ç–Ω–û–°–ò–¢–µ–õ–¨–ù–û–ô –í–õ–∞–ñ–ù–û- 100 –≥ –ø—Ä–Æ–î—É–∫–¢–∞ - —Å—Ç–∏ –≤–æ–∑–¥—É—Ö–∞ –Ω–µ 60–õ–µ–í 85 % –ù–æ–º–µ—Ä —Å–ºertl –î–∞–≤ –∏–∑: W(lma} –≥–æ—é–æ–í–ª–µ–Ω–∏—è (9–ú–û–õ–û –ú–†–°–Ø–¶ –¢–û–î); –∞—Å—Å–æ—Ä—Ç–∏–ú–µ–Ω—Ç–Ω—ã–π –í –õ—ë—Ä–≤–û–º –û–Ø–î–ö –Ω–æ–º–µ—Ä –∫–æ–Ω—Å–µ—Ä–≤–æ–≤ –¥–≤–µ —Ü–∏—Ñ—Ä–´) M–∏kitioawe –ú–µ—Å–Ø—Ü –ì–û–î) —É–∫–∞–ó–∞–ù–´ 8 –í–µ—Ä—Ö–Ω–µ–º –¢–ò–ß–ù–û–ô –£–§–∞–Ω–∏—å –øw–¥–µ–ºs (–ß–ò–°–õ–û, 80 –í–¢–û—Ä–û–ú —Ä–Ø–î—É: –ü–æ—Å–ª–µ –í–°–ö—Ä–´–¢–ò–Ø –ø–µ—Ä–∞—Ç—É—Ä–µ –ûT +2 "(–î–û 6 %( –∫–æW—É–Ωat –ò–ó–≥–û–¢–û–í–ò–¢–µ–õ–¨: 4315 2156 5928  –∞–∫—Ü–ò–û–ù–µ—Ä–ù–û–µ –æ–±—â–µ—Å—Ç–≤–æ –õ–µ–Ω–∏–Ω–∞ –¥ 131 54939,E-mail: –æ–±–ª , ‚Ç¨: –ì–ª—É–±–æ–∫–æ–µ —É–ø: '—Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –ø—Ä–∏–Ω–∏–º–∞–Æ–¢—Å—è b—É OT –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π –Ω–∞ –ö–ê–ù–¢ –¢–ê–ë–ò–ï–ò –ö–û–ô–´–¢–´–õ–ï–ê–ù —Çi–∫–µ–õ–µ–ô CYT bl (–æ—Ä—Ç–∞—à–∞ KZ –∂–∞—Ä–∞–º–¥—ã: 100 r –∫–µ—Ä–µ–∫  –ö—É—Ä–∞–º—ã: –û–Ω—ã–Ω –´, –ö–û–±I–ö –ø–∞–∫—Ç–æ–∑–∞) –∞–∫—É—ã–∑ –∫–æ–º—Ä—Å—É—Ç–µ–≥; I) –¢–£ –†–ë T–òBY 391537195.080-2020 546–≥ 43,5 –ì 82–≥ 0 ( –±ac—Ç–∞n 12 –ê–ò 75 –≥ 610 %–° ~–≥–µ –¥–µ–π—à–Ω–≥i –∂–∞–Ω–µ –ö–£–ù–î–´–õ–´–ì–™ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞–î–∞ (–∞–∞–ø–¥—ã–ª—å–∂—ã {–Ω–¥ –≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞–ª—ã–∫ Kkan –∞–π—ã ICamay –∫–∞–∂–µ—Ç –û–Ω–¥—Äi–ª–≥–µ–Ω –º–µ–ø—à–µ—Ä–≥ 100 –≥ –æ–Ω-–º–≥–µ - 13301 (–∫—É–Ω–ë; –õ–µ–º—Åa–Ω –æ–Ω–º–Ω–Ω –Ω–µ–ºi—Ä–ì; —Åx ; –∞—É—ã—Å—ã–º–Ω—ã–Ω  –Ω–æ–ºi—Ä–≥ –´–ù–î–∞–≥—ã –±i—Ä—à–Ω—ài –∫–∞—Ç–∞—Ä–¥–∞ –∫–µ—Ä—Å–µ—Ç–∏–≥–µ–Ω –ñ–∞—Ä–∞–º–¥–´–õ—ã–ö –º–µ—Ä–∑–º–Å (–ö—É–ù} db; –ñ–´–õ–´–Ø –ö–ò–º–£ [(–ö–ï–ú–ü—ë—Ä–∞–¢–∞—Ä—Ü–∞ –ö@—Ä–≥–µ—Ç–ª–≥–µ–Ω –ì–µ—Ä–º–µ—Ç–∏–∫–∞–ª—ã–∫ –∫–∞mt–∞—ã–∞H–¨–µ nlRdtRI –õH @–ùI–ú–î–ì 2 "8 26 Cre —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞–¥–∞ –∫–µ—Ä–µ–∫ –û–Ω–¥–≥—Ä—É—à—Ç–µ–±(–∏–±–û–°–ö–ò–ú–û–üI–Æ–ù–°–µ–û–í} –ö–û–ú–±–ò–ù–∞–¢–´> –∞–®–´–ö –≤–∞–±—Å–∫ 0–±21f6 {–û–Æ–û–µ –ö–ò –õ–µ–ù–ò–ù –ö–û–®,–∞–óy–ô–ì –∞–∫—Ü–∏–æ–Ω–µ—Ä–õ–ö KO–ü–ú –ë–†–õ–õIG–¨ Petile" –¢–µ–ø–µ—Ñ–æ–Ω–¥–∞—Ä: 375 2156 54928, 54039 e-mab –¥–∞–≥—ã –ü–ü—ã–Ω—É—à–´–ü–∞—Ä–î–∞–ù by J–ÆI–´` I Ul Rx –£–ü–û–¢—Ä–µ–±–ü–µ–ù–ò–Ø (–§—Ä–µ–î–ù–ò–µ –ó–ù–û–ß–û–ù–Æ –ø—Ä–û–î—É–∫–∞: (—Ö–∞–ü–û–ñ –®–ï–ù–ù–û–°–¨ (–∫–∞–ü–û—Ä–ú–ô–ù–û–°–´ –Ω–∞ [BJ XAwn yrn–£ ndkeld –£–ü–¶–ö–û–í–ö–ò –õ–ü–û–®I–ü  —Ç–µ—Ä–º–µ—Ç—å –ú–û–õ–û–ß–ù–æ–Ω—Å–µ—Ä–≤–Ω—ã–π –û—Ç–∫—Ä—ã—é–æ–µ –∫–ì–ª—É–±–û–ö–°–ö–ò–ô –¢–µ–ª–µ—Ñ–û–Ω—ã: –≠–ö–û–ù–û–ù–ò–ß–ï–°–ö–û–Æ–û –ë–µ–õ–∞—Ä—É—Å—å . –†–µ—Å–ø—É–±–ª–∏–∫–∞ 211793, –ï–≤—Ä–∞–∑–∏–π—Å–∫–æ–≥–æ –í–∏—Ç–µ–±—Å–∫–∞—è info@glmkkl –ü—Ä–µ—Ç–µ–Ω–∑–∏–∏ —Å–û–Æ–ó–∞ –ò–ó–≥–û–Æ–û–í–ò–¢–µ–ü–µ–ú: –ö–û–°–´–õ–ï–ê–ù –ö–ê–ö–ê–û –ü–ï–ù –ú–ê–ô–°–´–ó–î–ê–ù–î–´–†–´–õ–´–ü –ñ–ê–†–¢–´–õ–ê–ô 7,5%6 Y–õ–ï–°I –ú–ê–°–°–ê–õ–´–ö –º–∞–Ωi) –≠–Ω—ë–º –ö—É–Ω–î—ã–ø—ã–≥—ä Jdfduid –ê–ó–´–∫—Ç—ã–∫ –æ–Ωi–º–≥–µ: –∫–∞—Ä–∞–π –∫–∞–π–Ω–∞–≥–∞–Ω –∫–æ–ª–¥–∞–Ω—É–≥–∞ –ø—ài–Ω–∏–µ Ojfa –î–∞–º–Ω–µ –ö–∞–ª—ãm–∞–Ω–¥—ã—Ä—ãn–≥–∞–Ω –ö–û–°—É 9T —Å—Ö–∞—Ä–æ–∑–∞ –ö–∞HI [—Å–∞—Ö–∞—Ä–æ–∑–∞; —É–ΩtaFl –ö–µ–ü—Ä–ü (E50O –∫–∞–∫–∞–æ –º–∞–π 100098867122 2001 –∫–∞–øa–º–∞–¥–∞ macadn –ë—É—Ç–π–Ω –Æ–ø–µ–Ω –∂–∞—Ä–∞–º–¥—ã ; –î–µ–Ω –ö–∞–ø–æ—Ä–∏—è —ài–Ω–¥–µ —ã—Ä–º–∞–ø—ã canbal –∞—É–∞–Ω—ã–Ω –ú–∂/–≠20 –ª–∞–Ω –´–Ω –∞—Å–øanit –ñ—ã–ü—ã) —É–∞–∫–æ—Ç—ã ( on (6ip —Ç–∏–º–µ–Ω–ø–∫ Kaknaf –ö–£–¢–´–Ω—ã–Ω –´–Ω–î–∞–≥—ã –∫a–∫n–∞–ø –¥–µ–π–ø–Ω–≥; —Åa–∫idy 211793 ; imfo@glmkkl UIINI [—É—Ä–∞–ó–∏—è–ø—ã–ö –®d–´d-–î–´ –î–∞–ô–´–ù–î–∞–£–®–´ –ö–∞–±–´–ü–î–∞–ô–î–´ 41810108101341"""

    final_list = clean_and_split(raw_data)

    print(f"üì¶ –ò—Ç–æ–≥–æ–≤—ã–π —Å–ø–∏—Å–æ–∫ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤:")
    for idx, item in enumerate(final_list):
        print(f"{idx + 1}. {item}")
